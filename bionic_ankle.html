<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Projects - Eric Delgado</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" type="image/png" href="./Website_Pics/Favicon.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
            background-color: #151E3D;
            color: #99a5b1;
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        body.alt-color-scheme {
            background-color: #E4EFF1;
            color: black;
        }
        #right-panel {
            width: 90%;
            padding: 25px;
            box-sizing: border-box;
            overflow-y: auto;
            height: 100%;
            scroll-behavior: smooth;
        }
        #right-panel h5{
            color: lightgray;
            font-size: 24px;
            text-align: center;
        }
        body.alt-color-scheme #right-panel h5{
            color: #00243D;
        }
        .project-title {
            font-size: 60px;
            font-weight: bold;
            text-align: center;
            color: lightgray;
        }
        body.alt-color-scheme .project-title {
            color: #00243D;
        }
        .divider {
            width: 100%;
            height: 2px;
            background-color: lightgray;
            margin-bottom: 30px;
        }
        body.alt-color-scheme .divider {
            background-color: #00243D;
        }
        .categories-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
            text-align: center;
            position: -webkit-sticky; /* For Safari */
            position: sticky;
            top: 0;
            background-color: #151E3D; /* Match the body background color for seamless integration */
            z-index: 1000; /* Ensure it stays above other content */
            padding: 10px 0; /* Add padding for better visual spacing */
            border: 2px solid #ABA9C3; /* Add a border */
            border-radius: 8px; /* Optional: to make the corners rounded */
            box-sizing: border-box; /* Include padding and border in the element's total width and height */
        }
        body.alt-color-scheme .categories-container {
                background-color: #E4EFF1; /* Match the body background color for seamless integration */
                border: 2px solid #00243D; /* Add a border */
        }   
        .category {
            font-size: 24px;
            color: lightgray;
            text-decoration: none;
            padding: 10px 40px;
            border-radius: 5px;
            transition: background-color 0.3s;
        }
        body.alt-color-scheme .category {
            color: #151E3D;
        }
        body.alt-color-scheme .categories-container .category {
            color: black;
        }
        .category:hover {
            background-color: #22365e;
        }
        body.alt-color-scheme .category:hover {
            background-color: #c0c0c0;
        }
        .projects-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }
        .project {
            background-color: #1b2b4c;
            padding: 20px;
            border-radius: 10px;
            display: flex;
            flex-direction: row;
            align-items: center;
            cursor: pointer;
            transition: transform 0.3s, background-color 0.3s;
        }
        body.alt-color-scheme .project {
            background-color: #e0e0e0;
        }
        .project img {
            width: 30%;
            border-radius: 10px;
            margin-right: 15px;
        }
        .project-title-text {
            font-size: 24px;
            margin-bottom: 10px;
    
        }
        .project-description {
            font-size: 16px;
        }
        .project:hover {
            background-color: #22365e;
            transform: scale(1.05);
        }
        body.alt-color-scheme .project:hover {
            background-color: #c0c0c0;
        }
        .toggle-button {
            position: absolute;
            top: 20px;
            right: 20px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 24px;
            color: #99a5b1;
        }
        body.alt-color-scheme .toggle-button {
            color: #00243D;
        }
        .back-icon {
            position: absolute;
            top: 20px;
            left: 20px;
            font-size: 24px;
            color: #99a5b1;
            text-decoration: none;
        }
        body.alt-color-scheme .back-icon {
            color: #00243D;
        }
        .home-icon {
            position: absolute;
            top: 20px;
            right: 65px;
            font-size: 24px;
            color: #99a5b1;
            text-decoration: none;
        }
        body.alt-color-scheme .home-icon {
            color: #00243D;
        }
        .section {
            margin-bottom: 50px;
            display: flex;
            align-items: flex-start; /* Align items at the start */
            justify-content: space-between; /* Distribute space between items */
        }
        .section .description h2{
            font-size: 36px;
            color: lightgray;
        }
        body.alt-color-scheme .section .description h2{
            color: #151E3D
        }

        .section .description {
            width: 100%; /* Description takes up 70% of the width */
            margin-right: 20px; /* Space between description and image */
        }

        .section .image-container {
            margin-top: 100px;
            width: 40%; /* Image container takes up 25% of the width */
            display: flex;
            flex-direction: column;
            align-items: center; /* Center image and caption */
        }
        .section img, .section video {
            max-width: 100%;
            border-radius: 10px;
            border: 3px solid #99a5b1;
        }
        .section .image-caption {
            font-size: 14px; /* Smaller font for image caption */
            text-align: center;
            margin-top: 10px;
            color: #99a5b1;
        }
        .center-align {
            display: block;
            margin-left: auto;
            margin-right: auto;
        }
        .section .description white{
            color: lightgray;
        }
        body.alt-color-scheme .section .description white{
            color: black;
        }
    </style>
</head>
<body>
    <!-- House Icon -->
    <a href="projects.html" class="back-icon"><i class="fa-solid fa-arrow-left"></i></a>
    <a href="index.html" class="home-icon"><i class="fa-solid fa-house"></i></a>
 
    <button class="toggle-button"><i class="fas fa-moon"></i></button>
    
    <div id="right-panel">
        <div class="project-title">Bionic Ankle Prosthetic (In Progress)</div>
        <h5><white>Contributors: Daniel Levine, Thomas Larsen</white></h5>

        
        <!-- Table of Contents -->
        <div class="categories-container">
            <a href="#overview" class="category">Goal</a>
            <a href="#wallFollowing" class="category">Physical Design</a>
            <a href="#visual" class="category">PCB Design</a>
            <a href="#localization" class="category">Controls</a>
            <a href="#pathPlanning" class="category">Final Product</a>

        </div>
        
        <!-- Sections -->
        <div id="overview" class="section">
            <div class="description">
                <h2>Goal</h2>
                <p style="line-height: 2em;">&emsp; The goal of this project is to create an optimized parallel-spring bionic ankle prosthetic with an 
                    adaptive controller capable of biological gait for a wide range of patient weights, walking speeds, and inclines. For 
                this project, neural control will not be implemented - control will be soley based on state estimation gathered from a 
            6 DOF load cell, an IMU, encoders, and various other sensors. </p>
            <p style="line-height: 2em;">&emsp; This project was conceived and is headed by PhD student <white><strong>Daniel Levine</strong></white> with assistance 
                from multiple other sources including, but not limited to, <white><strong>Thomas Larsen</strong></white> and <white><strong>myself</strong></white>. 
                Thomas, with help from Daniel, was responsible for the motor design and tolerancing, while I assisted in much of the design of the external housing,  
                PCB Design, and the controls for the system. </p>
            </div>
            <div class="image-container">
                <img src="./Website_Pics/Full_Ankle.png" alt="Inverted Pendulum System">
                <div class="image-caption">CAD Model of the Full Bionic Ankle</div>
            </div>
        </div>
        
        
        <div id="wallFollowing" class="section">
            <div class="description">
                <h2>Physical Design</h2>
                <div style="float: left; margin-left: 25px; margin-bottom: 5px; width: 300px; display: flex; flex-direction: column;">
                    <figure style="margin-bottom: 5px;">
                        <img src="./Website_Pics/Generative.png" controls class="center-align" width="400px"></img>
                        <figcaption style="text-align: center; font-size: 14px; color: #99a5b1; margin-top: 5px;">
                            Generative Design Example: red = obstacle geometry, green = preserve geometry, blue = forces & moments
                        </figcaption>
                    </figure>
        
                    <figure>
                        <img src="./Website_Pics/Machined_Housing.png" controls class="center-align" width="400px"></img>
                        <figcaption style="text-align: center; font-size: 14px; color: #99a5b1; margin-top: 5px;">
                            5-axis milled housing
                        </figcaption>
                    </figure>
                </div>
                <p style="line-height: 2em;">&emsp; The main objective for the physical design of the ankle housing was to minimize 
                    the mass and the build height of the prosthesis so as to have a comfortable and widely available design 
                    respectively. After many iterations working with different pyramid attachments, I decided to design a housing that 
                mates to the load cell, essentially having a steel ground, allowing the housing to heavily minimize mass.  </p>
                <p style="line-height: 2em;">&emsp; I used Fusion to create the generative design - many key preserve geometries and 
                    obstacle geometries had already been created by <white><strong>Daniel Levine</strong></white>; I added the necessary
                    geometries to create the specific load cell housing. I also designed custom housing legs (frame to the left does not have 
                    them attached) so that the motor could be inserted and removed, and created GD&T Drawings for all necessary parts of the 
                    prosthesis.
                </p>
                <div style="float: right; margin-left: 25px; margin-bottom: 5px; width: 400px; display: flex; flex-direction: column;">
                    <figure style="margin-bottom: 5px;">
                        <img src="./Website_Pics/Fang_curve.png" controls class="center-align" width="400px"></img>
                        <figcaption style="text-align: center; font-size: 14px; color: #99a5b1; margin-top: 5px;">
                            Computed Fang Curve plotted
                        </figcaption>
                    </figure>
        
                    <figure>
                        <img src="./Website_Pics/Fang_pdf.png" controls class="center-align" width="400px"></img>
                        <figcaption style="text-align: center; font-size: 14px; color: #99a5b1; margin-top: 5px;">
                            GD&T Drawing of the cam-following fang 
                        </figcaption>
                    </figure>
                </div>
                <p style="line-height: 2em;">&emsp; Upon actuation of the motor, a lead screw flexes the active spring, injecting power into
                    the prosthesis. In this process, however, the spring bending changes the effective stiffness, introducing a nonlinearity.
                    To  better control the system, <white><strong>Daniel and I</strong></white> planned to create a cam-follower that
                    would follow along a cam path and change the nonlinearity of the bending spring. <white><strong>Daniel</strong></white> focused 
                    on a "fang" design that would perfectly cancel out the nonlinearity while I worked on a design to promote maxiumum deflection of the 
                    spring. To the right is my computed curve, and the associated GD&T Drawing of the final fang design. <white><strong>Daniel</strong></white>
                    computed his curve and made a similar fang, which we can easily switch out of the housing.
                </p>
                <p style="line-height: 2em;">&emsp; Additional components that I designed that were simpler components were: 
                    A custom heatsink that acts as both a heatsink and mount for the electronic components to the housing, encoder caps 
                    to house both the encoder and the magnet needed for angular state estimation, a bracket to hold the active spring in place 
                    relative to the housing, a bracket to guide the spring upon maximum deflection, and various other small assembly components.
                </p>
                <p style="line-height: 2em;">&emsp; (IN PROGRESS)
                </p>
            </div>
        </div>
        
        <div id="visual" class="section">
            <div class="description">
                <h2>PCB Design</h2>
                <figure style="float: right; margin-left: 25px; margin-bottom: 5px; width: 300px;">
                    <img src="./Website_Pics/PCB.png" controls class="center-align" width="400px"></img>
                    <figcaption style="text-align: center; font-size: 14px; color: #99a5b1; margin-top: 5px;">
                        Ankle Power Board Designed in Altium - 2.5 in x 2 in
                    </figcaption>
                </figure>
        
                <!-- Container for 3DPCB and CAN_Physical -->
                <div style="float: left; margin-left: 25px; margin-bottom: 5px; width: 300px; display: flex; flex-direction: column;">
                    <figure style="margin-bottom: 5px;">
                        <img src="./Website_Pics/3DPCB.png" controls class="center-align" width="400px"></img>
                        <figcaption style="text-align: center; font-size: 14px; color: #99a5b1; margin-top: 5px;">
                            Dual CAN Communication Board Designed in Altium (SMD) - 1 in x 1 in
                        </figcaption>
                    </figure>
        
                    <figure>
                        <img src="./Website_Pics/CAN_Physical.png" controls class="center-align" width="400px"></img>
                        <figcaption style="text-align: center; font-size: 14px; color: #99a5b1; margin-top: 5px;">
                            Preliminary Dual CAN Communication Board (THT) - 1.8 in x 2 in
                        </figcaption>
                    </figure>
                </div>
                <p style="line-height: 2em;">&emsp; For this project I also learned how to use Altium to design PCBs. The compute would be processed on the 
                    Verdin i.MX 8 Computer on Module mounted on the custom heatsink, along with an ingenia motor driver. To communicate between systems, a dual 
                    CAN communication board would be needed, along with a power board to take the voltage from the battery (48V) and power the Verdin (12V), the 
                    Ingenia (12V), and Data Aquisition System (12V) safely. There is a manual switch to initially power the Verdin - the 
                    power board also includes a mosfet logic gate to turn the ingenia on using signal from a GPIO pin 
                    located on the Verdin carrier, switching a relay on and powering the ingenia. 
                </p>
                <p style="line-height: 2em;">&emsp; (IN PROGRESS)
                </p>
            </div>
        </div>
        
        <div id="localization" class="section">
            <div class="description">
                <h2>Controls</h2>
                <p style="line-height: 2em;">&emsp; For fully adaptive control, Daniel and I plan to implement Model Predictive Control on the prosthesis. For this,
                    we first would need a trajectory to stabilize around, which neccessitates the implementation of trajectory optimization for the gait cycle - something 
                    we have implemented using pyDrake. To 
                    find our trajectory, we create a mathematical program with continuous variables for the timestep, the state variables, contact forces, and torques. 
                    To satisfy dynamics, we apply constraints on a variety of different aspects of the system (manipulator equations, inital condition, contact force and impulse,
                    mirrored initial and final state, etc.) to create the confines of a mirrored half-gait cycle. We then use a nonlinear solver 
                    (ex. Ipopt) to solve for the optimal trajectories while minimizing the energy expenditure of the system. This gives us the following 
                    trajectories seen below using different URDFs with varying levels of complexity in control of number of joints.                
                </p>
                <div style="float: left; margin-left: 5px; margin-bottom: 5px; width: 100%; display: flex; flex-direction: row;">
                    <figure style="margin-bottom: 5px;">
                        <video src="./Website_Pics/PendubotTrajOpt.mov" controls class="center-align" width="600px"></video>
                        <figcaption style="text-align: center; font-size: 14px; color: #99a5b1; margin-top: 5px;">
                            <p style="line-height: 2em;">&emsp;<a href="mpc_pendubot.html" class="link">Pendubot</a> TrajOpt</p>
                        </figcaption>
                    </figure>
        
                    <figure>
                        <video src="./Website_Pics/Piston_Walker.mov" controls class="center-align" width="90%"></video>
                        <figcaption style="text-align: center; font-size: 14px; color: #99a5b1; margin-top: 5px;">
                            Simple Piston Walker TrajOpt (hip, piston)
                        </figcaption>
                    </figure>
                    <figure>
                        <video src="./Website_Pics/Ankle_Walker.mov" controls class="center-align" width="90%"></video>
                        <figcaption style="text-align: center; font-size: 14px; color: #99a5b1; margin-top: 5px;">
                            Simple Ankle Walker TrajOpt (hip, ankle)
                        </figcaption>
                    </figure>
                    <figure>
                        <video src="./Website_Pics/Unconstrained_Walker.mov" controls class="center-align" width="90%"></video>
                        <figcaption style="text-align: center; font-size: 14px; color: #99a5b1; margin-top: 5px;">
                            Unconstrained Walker (shoulder, elbow, hip, knee, ankle)
                        </figcaption>
                    </figure>
                </div>
                <p style="line-height: 2em;">&emsp; The next steps may take two different paths. One path would be to take the approach of using
                    approximate closed form dynamics (inspiration taken from "3LP: a linear 3D-walking model including torso and swing dynamics"),
                    and define a leaf system where our model must satisfy these dynamics, can easily linearize them, and very quickly compute 
                    trajectories. This will allow us to implement receding-horizon MPC, calling trajectory optimizations at every time step, making 
                    the controller fully adaptive.
                </p>
                <p style="line-height: 2em;">&emsp; The alternative route would be to keep all the current constraints we have enforced in a mathematical 
                    program (not closed form), create a LeafSystem with these constraints applied, and use local linearizations of the dynamics to very quickly
                    solve local trajectory optimizations. This will also allow us to implement receding-horizon MPC.
                </p>
                <p style="line-height: 2em;">&emsp; I will also potentially accumulate a library of trajectories given various walking speeds, inclines, 
                    body weights, etc. and train a neural network on this data to create a black-box-type system to feed our state into and very quickly
                    (much quicker than TrajOpt) receive the desired trajectory.
                </p>
                <p style="line-height: 2em;">&emsp; (IN PROGRESS)
                </p>
            </div>

        </div>
        
        <div id="pathPlanning" class="section">
            <div class="description">
                <h2>Final Product</h2>
                <p style="line-height: 2em;">&emsp; (IN PROGRESS)
                </p>
            </div>
        </div>
    </div>
    
    <script>
        const toggleButton = document.querySelector('.toggle-button');
        toggleButton.addEventListener('click', () => {
            document.body.classList.toggle('alt-color-scheme');
            const icon = toggleButton.querySelector('i');
            if (document.body.classList.contains('alt-color-scheme')) {
                icon.classList.remove('fa-moon');
                icon.classList.add('fa-sun');
            } else {
                icon.classList.remove('fa-sun');
                icon.classList.add('fa-moon');
            }
        });
    </script>
</body>
</html>
